# 系统接线说明

## 硬件连接

### 1. TinyF 激光传感器连接
- VCC → 5V
- GND → GND
- TX → 数字引脚 0 (Arduino硬件串口RX)
- RX → 数字引脚 1 (Arduino硬件串口TX)

**注意**: 使用硬件串口时，无法同时进行串口调试

### 2. L298N 电机驱动模块连接 (控制灯光)
- ENA → 数字引脚 7 (PWM控制亮度)
- ENB → 数字引脚 2 (PWM控制亮度)
- IN1 → 数字引脚 5 (电机A方向控制)
- IN2 → 数字引脚 6 (电机A方向控制)
- IN3 → 数字引脚 4 (电机B方向控制)
- IN4 → 数字引脚 3 (电机B方向控制)
- VCC → 5V
- GND → GND
- 电机A/B → 连接到您的两个灯光

### 3. DFPlayer Mini 音频模块连接
- VCC → 5V
- GND → GND
- RX → 数字引脚 10 (Arduino发送数据给DFPlayer)
- TX → 数字引脚 11 (Arduino接收DFPlayer数据)
- SPK1, SPK2 → 连接到喇叭

**注意**: DFPlayer的RX连接到Arduino的TX引脚10，DFPlayer的TX连接到Arduino的RX引脚11

## 功能说明

### 距离分级系统

#### 灯光控制 (5个等级)
1. **0-40cm**: 亮度 255 (最亮)
2. **40-80cm**: 亮度 200
3. **80-120cm**: 亮度 150
4. **120-140cm**: 亮度 100
5. **140-180cm**: 亮度 50 (最暗)

#### 音频控制 (4个等级)
1. **0-10cm**: 播放音频文件 1
2. **10-20cm**: 播放音频文件 2
3. **20-30cm**: 播放音频文件 3
4. **30-40cm**: 播放音频文件 4

### 音频文件准备
请将以下音频文件放入DFPlayer Mini的SD卡中：
- 001.mp3 (对应0-10cm距离)
- 002.mp3 (对应10-20cm距离)
- 003.mp3 (对应20-30cm距离)
- 004.mp3 (对应30-40cm距离)

## 系统特性

1. **TinyF传感器集成**: 自动读取TinyF激光传感器的距离数据
2. **防重复播放**: 相同距离范围的音频不会重复播放，间隔至少2秒
3. **实时响应**: 距离变化时灯光和音频会立即响应
4. **调试信息**: 串口会输出详细的距离、等级和亮度信息
5. **范围限制**: 超出设定范围的信号会被过滤
6. **双重数据源**: 支持TinyF传感器自动读取和串口手动输入

## 使用说明

1. 上传代码到Arduino
2. 打开串口监视器 (115200波特率)
3. 系统会自动从TinyF传感器读取距离数据
4. 也可以通过串口手动发送距离数据，格式: "距离值,置信度"
5. 系统会根据距离自动控制灯光亮度和播放相应音频

## 注意事项

1. 确保DFPlayer Mini的SD卡格式为FAT32
2. 音频文件命名必须严格按照001.mp3, 002.mp3等格式
3. L298N模块需要外部电源供电，不能仅依靠Arduino的5V
4. TinyF传感器使用9600波特率通信
5. 建议在测试时先连接串口监视器观察调试信息
6. TinyF传感器的TX连接到Arduino的RX引脚8，RX连接到Arduino的TX引脚9